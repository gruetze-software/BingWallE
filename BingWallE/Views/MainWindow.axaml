<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BingWallE.ViewModels"
        x:Class="BingWallE.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="{Binding AppTitle}"
        Background="#1C1C1C" Foreground="White"
        Width="600" Height="450" WindowStartupLocation="CenterScreen">

    <Grid RowDefinitions="Auto, *, Auto" Margin="15">
        <StackPanel Grid.Row="0" Spacing="8">
            <DockPanel>
                <Button Content="..." 
                    Command="{Binding SelectFolderCommand}" 
                    DockPanel.Dock="Right" Margin="5,0,0,0"/>
                <TextBox Text="{Binding TargetFolder}" IsReadOnly="True" Watermark="Saving places..."/>
            </DockPanel>
            <Button Content="{Binding ButtonText}" 
                Command="{Binding StartStopCommand}" 
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center" 
                VerticalContentAlignment="Center"
                CornerRadius="5"
                Background="DarkSlateBlue" Foreground="White"/>
            <TextBlock Text="{Binding StatusMessage}" 
                Foreground="{Binding StatusColor}" 
                HorizontalAlignment="Center" 
                FontSize="12"/>
        </StackPanel>

        <ListBox Grid.Row="1" ItemsSource="{Binding Wallpapers}" Margin="0,10">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="Auto, Auto, *" Margin="8,4">
                        <CheckBox IsChecked="{Binding IsSelected}" VerticalAlignment="Center" Margin="0,0,12,0"/>
                        
                        <Border Grid.Column="1" Width="100" Height="60" CornerRadius="4" ClipToBounds="True" BoxShadow="0 2 5 0 #40000000">
                            <Image Source="{Binding Preview}" Stretch="UniformToFill" />
                        </Border>

                        <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="15,0,0,0">
                            <TextBlock Text="{Binding Title}" FontWeight="SemiBold" FontSize="14" TextTrimming="CharacterEllipsis"/>
                            <TextBlock Text="{Binding Date}" FontSize="11" Opacity="0.6"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <Button Grid.Row="2" Content="Download selected" 
            Command="{Binding DownloadSelectedCommand}" 
            HorizontalAlignment="Stretch" 
            HorizontalContentAlignment="Center"
            VerticalContentAlignment="Center"
            CornerRadius="5"
            Height="45" Background="ForestGreen" Foreground="White"/>
    </Grid>
</Window>